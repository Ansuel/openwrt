From 72562134d09b1f6880db214772b8d646c9be0304 Mon Sep 17 00:00:00 2001
From: Michal Hrusecky <michal.hrusecky@nic.cz>
Date: Wed, 5 Oct 2016 08:00:21 +0200
Subject: [PATCH] irssi

---
 net/irssi/Makefile                       |  8 ++++----
 net/irssi/patches/wrong-definition.patch | 28 ++++++++++++++++++++++++++++
 2 files changed, 32 insertions(+), 4 deletions(-)
 create mode 100644 net/irssi/patches/wrong-definition.patch

diff --git a/net/irssi/Makefile b/net/irssi/Makefile
index 3fbfef1..c989cf3 100644
--- a/net/irssi/Makefile
+++ b/net/irssi/Makefile
@@ -8,12 +8,12 @@
 include $(TOPDIR)/rules.mk
 
 PKG_NAME:=irssi
-PKG_VERSION:=0.8.17
+PKG_VERSION:=0.8.20
 PKG_RELEASE:=1
 
-PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.bz2
-PKG_SOURCE_URL:=http://irssi.org/files/
-PKG_MD5SUM:=ecf64be47978d89a742b435a81cb47db
+PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.xz
+PKG_SOURCE_URL:=https://github.com/irssi/irssi/releases/download/$(PKG_VERSION)/
+PKG_MD5SUM:=67d48c5feec2d3b949d088aa4abc3601
 
 PKG_FIXUP:=autoreconf
 PKG_INSTALL:=1
diff --git a/net/irssi/patches/wrong-definition.patch b/net/irssi/patches/wrong-definition.patch
new file mode 100644
index 0000000..a162198
--- /dev/null
+++ b/net/irssi/patches/wrong-definition.patch
@@ -0,0 +1,28 @@
+--- a/src/fe-text/term.h
++++ b/src/fe-text/term.h
+@@ -83,7 +83,7 @@ void term_set_color(TERM_WINDOW *window,
+ void term_move(TERM_WINDOW *window, int x, int y);
+ void term_addch(TERM_WINDOW *window, char chr);
+ void term_add_unichar(TERM_WINDOW *window, unichar chr);
+-int  term_addstr(TERM_WINDOW *window, const char *str);
++int term_addstr(TERM_WINDOW *window, const char *str);
+ void term_clrtoeol(TERM_WINDOW *window);
+ 
+ void term_move_cursor(int x, int y);
+@@ -94,8 +94,10 @@ void term_refresh(TERM_WINDOW *window);
+ 
+ void term_stop(void);
+ 
++#ifdef USE_CURSES
+ void term_set_appkey_mode(int enable);
+ void term_set_bracketed_paste_mode(int enable);
++#endif
+ 
+ /* keyboard input handling */
+ void term_set_input_type(int type);
+--- a/src/fe-text/term-curses.c
++++ b/src/fe-text/term-curses.c
+@@ -335,9 +335,13 @@ void term_add_unichar(TERM_WINDOW *windo
+         waddch(window->win, chr);
+ }
+ 
-- 
2.10.0

